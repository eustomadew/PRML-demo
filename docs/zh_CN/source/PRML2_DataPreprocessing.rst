=====================
数据挖掘导论
=====================


---------------------
DM 任务分类
---------------------
.. 绪论

数据挖掘任务通常分为两大类：

- **预测任务**

    - 目标：根据其他属性的值，预测特定属性的值。
    - *目标变量 (target variable)* / *因变量 (dependent variable)*: 被预测的属性。
    - *说明变量 (explanatory variable)* / *自变量 (independent variable)*: 用来做预测的属性。

- **描述任务**

    - 目标: 导出概括数据中潜在联系的模式 (相关、趋势、聚类、轨迹和异常)。
    - 本质上，描述性数据挖掘任务通常是探查性的，并且常常需要后处理技术验证和解释结果。

.. admonition:: 四种主要数据挖掘任务 (数据)：

    - 预测建模 (predictive modeling)

        - 分类 (classification)
        - 回归 (regression)

    - 关联分析 (association analysis)
    - 聚类分析 (cluster analysis)
    - 异常检测 (anomaly detection)

- 预测建模 (predictive modeling)

    - 以说明变量函数的方式为目标变量建立模型
    - 有两类预测建模任务

        - 分类 (classification): 用于预测离散的目标变量
        - 回归 (regression): 用于预测连续的目标变量

    - 任务目标：训练一个模型，使目标变量预测值与实际值之间的误差达到最小
    - e.g.,: 可以用来确定顾客对产品促销活动的反应、预测地球生态系统的扰动、或根据检查结果判断病人是否患有某种疾病。

- 关联分析 (association analysis)

    - 用来发现描述数据中强关联特征的模式；所发现的模式通常用蕴涵规则或特征子集的形式表示。
    - 由于搜索空间是指数规模的，关联分析的目标是以有效的方式提取最有趣的模式。
    - 应用：e.g., 文档聚类；找出具有相关功能的基因组、识别用户一起访问的 Web 页面、理解地球气候系统不同元素之间的联系等。

- 聚类分析 (cluster analysis)

    - 旨在发现紧密相关的观测值组群，使得与属于不同簇的观测值相比，属于同一簇的观测值相互之间尽可能类似。
    - 聚类可用来对相关的顾客分组、找出显著影响地球气候的海洋区域以及压缩数据等。

- 异常检测 (anomaly detection)

    - 任务：识别其特征显著不同于其他数据的观测值，即 *异常点 (anomaly)* 或 *离群点 (outlier)* 。
    - 目标：发现真正的异常点，而避免错误地将正常的对象标注为异常点。
    - i.e., 一个好的异常检测器必须具有高检测率和低误报率。
    - 应用：e.g., 信用卡欺诈检测；检测欺诈、网络攻击、疾病的不寻常模式、生态系统扰动等。



---------------------
数据相关
---------------------

- **数据类型**

    - 数据集的不同表现在多方面，例如：

        - 用来描述数据对象的属性可以具有不同的类型——定量的或定性的，并且
        - 数据集可能具有特定的性质，如某些数据集包含时间序列或彼此之间具有明显联系的对象。

    - 数据的类型决定我们应使用何种工具和技术来分析数据。
    - 数据挖掘研究常常是为了适应新的应用领域和新的数据类型的需要而展开的。

- **数据质量**

    - 数据通常远非完美。
    - 虽然大部分DM技术可容忍部分程度上的数据不完美；但是 *注重理解和提高数据质量* 将改进分析结果的质量。
    - 通常必须解决的数据质量问题包括

        - 存在噪声和离群点、
        - 数据遗漏、
        - 不一致或重复、
        - 数据有偏差或者不能代表它应该描述的现象或总体情况。

- **使数据适合挖掘的预处理步骤**

    - 通常，原始数据必须加以处理才能适合于分析。
    - 处理一方面是要提高数据的质量；另一方面要让数据更好地适应特定的数据挖掘技术或工具。

        - 例如，可能需要将连续值属性 (如长度) 转换成具有离散的分类值的属性 (如短、中、长)，以便应用特定技术；
        - 又如，数据集属性的数目常常需要减少，因为属性较少时许多技术用起来更加有效。

- **根据数据联系分析数据**

    - 数据分析的一种方法是找出数据对象之间的联系，之后使用这些联系而不是数据对象本身来进行其余的分析。
    - 例如，可以计算对象之间的相似度或距离，然后根据这种相似度或距离进行分析——聚类、分类或异常检测。
    - 诸如此类的相似性或距离度量很多，要根据数据的类型和特定的应用做出正确的选择。


数据类型
=====================

通常，**数据集** 可以看做数据对象的集合。 
**数据对象** 有时也叫作 *记录、点、向量、模式、事件、案例、样本、观测* 或 *实体*。
数据对象用一组刻画对象基本特性 (如物体质量或事件发生时间) 的属性描述。
**属性** 有时也叫作 *变量、特性、字段、特征* 或 *维*。


属性与度量
---------------------

.. admonition:: 1. 什么是属性

    - **属性 (attribute)**: 是对象的性质或特性；因对象而异，或随时间而变化。 e.g., 

        - 符号属性: 具有少量可能的值。e.g., 眼球颜色 :math:`\in` {棕色、黑色、蓝色、绿色、淡褐色……}
        - 数值属性: 可以取无穷多个值。e.g., 温度
        - 追根溯源，属性并非数字或符号。然而为了讨论和精细地分析对象的特性，我们为它们赋予了数字或符号。为了用一种明确定义的方式做到这一点，我们需要测量标度。

    - **测量标度 (measurement scale)**: 是将数值或符号值与对象的属性相关联的规则 (函数)。
    
        - 形式上，*测量过程* 是使用测量标度将一个值与一个特定对象的特定属性相关联。
        - e.g., 上秤称体重；将人分男女；清点椅子数目，确定能否为所有与会者提供足够的座位。
        - 在所有这些情况下，对象属性的“物理值”都被映射到数值或符号值。

.. admonition:: 2. 属性类型

    - **属性类型**

        - 属性的性质不必与用来度量它的值的性质相同。
        - i.e., 用来代表属性的值可能具有不同于属性本身的性质，并且反之亦然。
        - 属性可以用一种不描述属性全部性质的方式测量。 e.g., 线段长度
        - 通常将属性的类型称作 **测量标度的类型** 。

    - **属性的不同类型**

        - 数值的如下性质(操作)常常用来描述属性: 相异性、序、加法、乘法。
        - 给定这些性质，可以定义四种属性类型：

            - 标称 (nominal)
            - 序数 (ordinal)
            - 区间 (interval)
            - 比率 (ratio)

        - 属性类型的定义是累积的。

            - 每种属性类型拥有其上方属性类型上的所有性质和操作；
            - 但对于某种属性类型合适的操作，对其上方的属性类型都不一定合适。


.. admonition:: 3. 属性的不同类型

    四种属性类型的允许的(保持意义的)变换
.. 不同的属性类型

================== ====== ================================================================== ========================================
 表: 不同的属性类型
-------------------------------------------------------------------------------------------------------------------------------------
  属性类型          \         描述    (例子)                                                     操作
================== ====== ================================================================== ========================================
 分类的 (定性的)     标称    值仅是不同的名字，即只提供</br>足够的信息以区分对象 (\eq,\neq)         众数、熵、列联相关、卡方检验  
\                   序数    值提供足够的信息确定对象的序 (<,>)                                   中值、百分位、秩检验、游程检验、符号检验  
 数值的 (定量的)     区间    值之差有意义，即存在测量单位 (+,-)                                   均值、标准差、皮尔逊相关、*t* 和 *F* 检验  
\                   比率    差和比率都有意义 (\*,/)                                             几何平均、调和平均、百分比变差  
================== ====== ================================================================== ========================================

================ ========= =========================================================================================
 表: 定义属性层次的变换
--------------------------------------------------------------------------------------------------------------------
 属性类型         \          变换
================ ========= =========================================================================================
 分类的(定性的)     标称      任何一对一变换，例如值的一个排列
\                  序数      值的保序变换，即 ``新值 = f(旧值)``，其中 *f* 是单调函数
 数值的(定量的)     区间      ``新值 = a* 旧值 +b``，其中 *a,b* 是常数
\                  比率      ``新值 = a* 旧值``
================ ========= =========================================================================================

.. admonition:: 4. 用值的个数描述属性

    区分属性的一种独立方法是根据属性可能取值的个数来判断。

    - 离散的 (discrete): 
    - 连续的 (continuous): 

.. admonition:: 5. 非对称的属性

    对于非对称的属性 (asymmetric attribute)，出现非零属性值才是重要的。


数据集的类型
---------------------

.. admonition:: 1. 数据集的一般特性

    在提供特定类型数据集的细节之前，我们先讨论适用于许多数据集的三个特性，它们对数据挖掘技术具有重要影响，它们是维度、稀疏性和分辨率。

    - 维度 (dimensionality)
    - 稀疏性 (sparsity)
    - 分辨率 (resolution)

.. admonition:: 2. 记录数据

    许多数据挖掘任务都假定数据集是记录(数据对象)的汇集，每个记录包含固定的数据字段(属性)集。

.. admonition:: 3. 基于图形的数据

    有时，图形可以方便而有效地表示数据。
    我们考虑两种特殊情况：

    - (1) 图形捕获数据对象之间的联系，
    - (2) 数据对象本身用图形表示。

.. admonition:: 4. 有序数据

    对于某些数据类型，属性具有涉及时间或空间序的联系。

    - 时序数据 (sequential data) / 时间数据 (temporal data)
    - 序列数据 (sequence data)
    - 时间序列数据 (time series data)

        - 一种特殊的时序数据，其中每个记录都是一个时间序列 (time series)，即一段时间以来的测量序列
        - 分析时考虑 **时间自相关 (temporal autocorrelation)**，即如果两个测量的时间很接近，则这些测量的值通常非常相似

    - 空间数据

        - 重要特点之一是 **空间自相关 (spatial autocorrelation) 性**，即物理上靠近的对象趋向于在其他方面也相似

.. admonition:: 5. 处理非记录数据

    大部分数据挖掘算法都是为记录数据或其变体(如事物数据和数据矩阵)设计的。通过从数据对象中提取特征，并使用这些特征创建对应于每个对象的记录，针对记录数据的技术也可以用于非记录数据。
    在某些情况下，数据的记录形式表示不能捕获数据中的所有信息，如时间空间数据中属性之间存在的时间联系以及对象之间存在的空间联系应加以考虑，直接假定属性之间在统计上相互独立并不明智。



数据质量
=====================

数据挖掘着眼于两个方面：

1. 数据质量问题的检测和纠正；
2. 使用可以容忍低质量数据的算法。

Step 1 的检测和纠正，通常称作 **数据清理 (data cleaning)**。

1. 测量误差 (measurement error) 和数据收集错误 (data collection error)
2. 噪声和伪像: 鲁棒算法 (robust algorithm), 伪像 (artifact)
3. 精度 (precision)、偏倚 (bias) 和准确率 (accuracy): 有效数字 (significant digit)
4. 离群点 (outlier)
5. 遗漏值: 常用处理策略

    - 删除数据对象或属性
    - 估计遗漏值
    - 在分析时忽略遗漏值

6. 不一致的值
7. 重复数据: 去重复 (deduplication)

从 **应用角度** 考虑数据质量问题

- 时效性
- 相关性: 常见问题是抽样偏倚 (sampling bias)
- 关于数据的知识


数据预处理
=====================

大体分为两类：选择分析所需要的数据对象和属性，以及创建/改变属性

目标：改善数据挖掘分析工作，减少时间，降低成本和提高质量

术语：特征 (feature) = 变量 (variable) = 属性 (attribute)


预处理技术主题：

- 聚集 (aggregation)
- 抽样

    - 简单随机抽样 (simple random sampling): 1) 无放回抽样; 2) 有放回抽样
    - 分层抽样 (stratified sampling)
    - 自适应 (adaptive) 或渐进抽样 (progressive sampling)

- 维归约

    - 维灾难
    - 基于线性代数方法的维归约技术

        - 使用线性代数方法，将数据由高维空间投影到低维空间
        - 主成分分析 (Principal Components Analysis, PCA): 连续属性
        - 奇异值分解 (Singular Value Decomposition, SVD)

- 特征子集选择

    - *冗余特征*: 重复了包含在一个或多个其他属性中的许多或所有信息
    - *不相关特征*: 包含对于数据挖掘任务几乎完全没用的信息
    - 涉及 :math:`n` 个属性的子集多达 :math:`2^n` 个
    - 三种标准的特征选择方法：

        - 嵌入 (embedded approach): 作为DM算法的一部分，在运行期间选择属性
        - 过滤 (filter approach): 使用独立于DM任务的方法，在算法执行前进行特征选择
        - 包装 (wrapper approach): 将目标DM算法作为黑盒，使用类似于之前的理想算法，但在寻找最佳属性子集的过程中通常并不枚举所有可能的子集

    - 进一步讨论过滤和包装方法

        - 1. 特征子集选择体系结构

            - 特征选择过程: 子集评估度量、控制新的特征子集产生的搜索策略、停止搜索判断和验证过程
            - 过滤与包装的区别: 使用不同的特征子集评估方法。包装：子集评估使用目标数据挖掘算法；过滤：子集评估技术不同于目标数据挖掘算法
            - 特征子集选择是搜索所有可能的特征子集的过程，需折衷权衡“搜索策略的计算花费应较低”和“特征子集应尽可能优”
            - 对于搜索，其评估步骤不可或缺，即根据某种评估度量来确定属性特征子集的质量。过滤：评估度量试图预测实际的DM算法在给定属性集上的执行效果；包装：评估包括实际运行目标DM应用，子集评估函数是通常用于度量数据挖掘结果的评判标准
            - 限于子集集合的规模，需要某种停止搜索判断，其策略通常基于如下一个或多个条件：迭代次数，子集评估的度量值是否最优或超过给定阈值，一个特定大小的子集是否已经得到，大小和评估标准是否同时达到，使用搜索策略得到的选择是否可以实现改进
            - 选定特征子集后应验证目标DM算法在选定子集上的效果。一种验证方法是比较在所有特征集合和给定特征子集上运行DM算法的结果，期待在子集上获得的结果等同或优于在全集合上的结果。另一种验证方法是使用不同特征选择算法得到特征子集，然后比较数据挖掘算法在每个子集上的运行结果。

        - 2. 特征加权

- 特征创建

    - 1. 特征提取 (feature extraction): 由原始数据创建新的特征集
    - 2. 映射数据到新的空间: e.g., 傅里叶变换 (Fourier transform)、小波变换 (wavelet transform) etc
    - 3. 特征构造

- 离散化 (discretization) 和二元化 (binarization)

    - 1. 二元化
    - 2. 连续属性离散化: 非监督离散化、监督离散化
    - 3. 具有过多值的分类属性

- 変量変换 (variable transformation)

    - 1. 简单函数
    - 2. 规范化 (normalization) 或标准化 (standardization)


相似性和相异性的度量
=====================

邻近度 (proximity): 相似性 (similarity), 相异性 (dissimilarity) / 距离 (distance)

距离 & 距离矩阵 (distance matrix)

- 欧几里得距离 (Euclidean distance): 
  :math:`d(\mathbf{x},\mathbf{y}) = \sqrt{\sum_{k=1}^n (x_k-y_k)^2}`
- 闵可夫斯基距离 (Minkowski distance): 
  :math:`d(\mathbf{x},\mathbf{y}) = \left( \sum_{k=1}^n |x_k-y_k|^r \right)^{1/r}`

    - :math:`r=1` : 城市街区(/曼哈顿/出租车/ :math:`L_1` 范数)距离，e.g., 汉明距离 (Hamming distance)
    - :math:`r=2` : 欧几里得距离 ( :math:`L_2` 范数)
    - :math:`r=\infty` : 上确界 (:math:`L_{max}` 或 :math:`L_\infty` 范数) 距离，是对象属性之间的最大距离，即
      :math:`d(\mathbf{x},\mathbf{y}) = \lim_{r\to \infty} \left( \sum_{k=1}^n|x_k-y_k|^r \right)^{1/r}`

- 注意区分 *r* 和 *n*。以及所有的距离矩阵都是对称的
- 距离的性质 :math:`\forall \mathbf{x,y}`

    - 非负性 :math:`d(\mathbf{x,y})\geqslant 0`，等号成立当且仅当 :math:`\mathbf{x}=\mathbf{y}`
    - 对称性 :math:`d(\mathbf{x,y}) = d(\mathbf{y,x})`
    - 三角不等式 :math:`\forall \mathbf{x,y,z},\, d(\mathbf{x,z})\leqslant d(\mathbf{x,y}) + d(\mathbf{y,z})`
    - 同时满足以上三个性质的测度称为度量 (metric)
    - e.g., 非度量的相异度：集合差，只满足非负性
    - e.g., 非度量的相异度：时间

相似度：三角不等式通常不成立，对称性和非负性通常成立

- To be specific, :math:`s(\mathbf{x,y})` 的典型性质
- (1) :math:`s(\mathbf{x,y})=1` 当且仅当 :math:`\mathbf{x}=\mathbf{y}`, :math:`(0\leqslant s\leqslant 1)`
- (2) :math:`\forall \mathbf{x,y},\, s(\mathbf{x,y}) = s(\mathbf{y,x})` (对称性)
- e.g., 非对称相似性度量

**邻近性度量的例子**

1. 二元数据的相似性度量

    - 两个仅包含二元属性的对象之间的相似性度量又称相似系数 (similarity coefficient) :math:`\in [0,1]` 
        - :math:`f_{00}=` 属性个数 of :math:`\mathbf{x}=0, \mathbf{y}=0`
        - :math:`f_{01}=` 属性个数 of :math:`\mathbf{x}=0, \mathbf{y}=1`
        - :math:`f_{10}=` 属性个数 of :math:`\mathbf{x}=1, \mathbf{y}=0`
        - :math:`f_{11}=` 属性个数 of :math:`\mathbf{x}=1, \mathbf{y}=1`

    - 简单匹配系数 (Simple Matching Coefficient, SMC):
      :math:`SMC = \frac{\text{值匹配的属性个数}}{\text{属性个数}} = \frac{ f_{11}+f{00} }{ f_{01}+f_{10}+f_{11}+f_{00} }`
    - Jaccard 系数 (Jaccard Coefficient):
      :math:`J = \frac{\text{匹配的个数}}{\text{不涉及0-0匹配的属性个数}} = \frac{ f_{11} }{ f_{01}+f_{10}+f_{11} }`

2. 余弦相似度 (cosine similarity): 
:math:`\cos(\mathbf{x,y}) = \frac{ \mathbf{x}\cdot\mathbf{y} }{ \|\mathbf{x}\| \cdot \|\mathbf{y}\| }`, 

    - 其中 :math:`\mathbf{x}\cdot\mathbf{y}= \sum_{k=1}^n x_ky_k`, 
    - 而向量长度/模为 :math:`\|\mathbf{x}\| = \sqrt{\sum_{k=1}^nx_k^2} = \sqrt{\mathbf{x}\cdot\mathbf{x}}`

3. 广义 Jaccard 系数 / Tanimoto 系数:
:math:`EJ(\mathbf{x,y}) = \frac{ \mathbf{x}\cdot\mathbf{y} }{ \|\mathbf{x}\|^2 + \|\mathbf{y}\|^2 - \mathbf{x}\cdot\mathbf{y} }`

4. 相关性: 皮尔森相关 (Pearson's correlation) 系数
:math:`corr(\mathbf{x,y}) = \frac{covariance(\mathbf{x,y})}{standard\_deviation(\mathbf{x}) \times standard\_deviation(\mathbf{y})} = \frac{ s_{xy} }{ s_xs_y }`

    - 使用标准的统计学记号和定义：
    - :math:`covariance(\mathbf{x,y}) = s_{xy} = \frac{1}{n-1} \sum_{k=1}^n (x_k-\bar{x})(y_k-\bar{y})`
    - :math:`standard\_deviation(\mathbf{x}) = s_x = \sqrt{\frac{1}{n-1} \sum_{k=1}^n (x_k-\bar{x})^2}`
    - :math:`standard\_deviation(\mathbf{y}) = s_y = \sqrt{\frac{1}{n-1} \sum_{k=1}^n (y_k-\bar{y})^2}`
    - :math:`\bar{x} = \frac{1}{n} \sum_{k=1}^n x_k` 是 :math:`\mathbf{x}` 的均值
    - :math:`\bar{y} = \frac{1}{n} \sum_{k=1}^n y_k` 是 :math:`\mathbf{y}` 的均值


---------------------
探索数据
---------------------


你好
=====================


探索数据
=====================




